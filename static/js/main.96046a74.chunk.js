(this.webpackJsonpdshub=this.webpackJsonpdshub||[]).push([[0],{341:function(e,t,n){},647:function(e,t,n){"use strict";n.r(t);var r=n(6),o=n(0),i=n.n(o),a=n(21),c=n.n(a),s=Object({NODE_ENV:"production",PUBLIC_URL:"/dshub",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_MIXPANEL_TOKEN||"fb25742efb56d116b736515a0ad5f6ef",l=n(238),u=n.n(l);u.a.init(s);var d,p=u.a,g=(n(341),n(311)),h=n(28),f=(n(342),n(343),n(67)),b=n(33),j=["error"],v=function(e){var t=e.type,n=e.title,o=e.size,i=void 0===o?150:o,a=e.children;return Object(r.jsxs)(m,{children:[j.includes(t.toLocaleLowerCase())?Object(r.jsx)(w,{type:t,size:i}):Object(r.jsx)(O,{children:Object(r.jsx)(b.b,{type:t,style:{width:i}})}),n&&Object(r.jsx)(x,{level:5,children:n}),Object(r.jsx)(y,{children:a})]})},m=h.c.div.withConfig({displayName:"InfoMessage__StyledContainer",componentId:"sc-1azsubb-0"})(["display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;"]),O=h.c.div.withConfig({displayName:"InfoMessage__StyledGraphic",componentId:"sc-1azsubb-1"})(["margin:1rem 0;"]),x=Object(h.c)(b.f).withConfig({displayName:"InfoMessage__StyledTitle",componentId:"sc-1azsubb-2"})(["margin:0.5rem 0;"]),y=h.c.div.withConfig({displayName:"InfoMessage__StyledContent",componentId:"sc-1azsubb-3"})(["text-align:center;"]),w=h.c.div.withConfig({displayName:"InfoMessage__StyledIcon",componentId:"sc-1azsubb-4"})(["display:inline-block;width:",";height:",";background:",";background-size:cover;"],(function(e){return"".concat(e.size,"px")}),(function(e){return"".concat(e.size,"px")}),(function(e){return"transparent url('/images/graphics/".concat(e.type.toLocaleLowerCase(),".svg') center center no-repeat")})),k=n(77),I=n(42),C=n(31),_=n.n(C),S=n(46),A=n(40),T=Object(f.createTypedHooks)(),z=T.useStoreActions,L=(T.useStoreDispatch,T.useStoreState),E=n(331),F=n(656),P=n(657),N=n(89),D={sdk:new N.CogniteClient({appId:"il-tempo-gigante"}),resetSdk:Object(f.action)((function(e,t){e.sdk=t}))},U=function(){return z((function(e){return e.sdk.resetSdk}))},R=n(139),W=n(60);!function(e){e[e.Azure=0]="Azure",e[e.Auth0=1]="Auth0"}(d||(d={}));var M,H=n(64),K=n.n(H),B=n(90),q=n.n(B),G="itg_env_pref";function J(){var e=Object(I.g)(),t=q.a.parse(e.search),n=window.localStorage.getItem(G)||"";try{n=JSON.parse(n)}catch(o){}var r=t.env;return r instanceof Array?r[0]||"":n||r||"0"}!function(e){e[e.apikey=0]="apikey",e[e.oauth=1]="oauth",e[e.tenant=2]="tenant"}(M||(M={}));var Y=function(e){return e||"2f046eb0-9e5a-4400-b05e-b8e4d5d79405"},Z="__itg__api_key",$="__itg__tenant",Q={apiKey:localStorage.getItem(Z)||void 0,tenant:localStorage.getItem($)||void 0,cluster:void 0,email:void 0,token:void 0,loggedIn:void 0,setLoggedIn:Object(f.action)((function(e,t){if(t){var n=t.apiKey,r=t.tenant,o=t.cluster,i=t.loginType,a=t.email;r&&0!==r.length&&(localStorage.setItem($,r),e.tenant=r),n&&0!==n.length&&(localStorage.setItem(Z,n),e.apiKey=n,e.token=n),o&&0!==o.length&&(localStorage.setItem("__itg__cluster",o),e.cluster=o),a&&0!==a.length&&(e.email=a.toLowerCase()),i.toString()&&(e.loggedIn=!0)}else e.apiKey=void 0,e.token=void 0,e.tenant=void 0,e.cluster=void 0,e.email=void 0,e.loggedIn=void 0})),updateToken:Object(f.action)((function(e,t){e.token=t,e.tenant||(e.tenant=localStorage.getItem($)||void 0)}))},X=function(e){return K.a.isString(e)?e:e.cluster},V=function(e,t,n){var r={audience:(null===t||void 0===t?void 0:t.directory)||""};return e.provider===d.Azure?{type:"AAD_OAUTH",options:{clientId:e.id,cluster:e.cluster||"api",tenantId:null===t||void 0===t?void 0:t.directory,signInType:{type:"loginRedirect",requestParams:{prompt:n}}}}:{type:"OIDC_AUTHORIZATION_CODE_FLOW",options:{clientId:e.id,cluster:e.cluster||"api",openIdConfigurationUrl:e.configurationUrl,responseMode:"query",responseType:"code",extraScope:"openid profile offline_access",authenticateParams:r,refreshParams:r,loginParams:{prompt:n}}}},ee=function(){var e=z((function(e){return e.auth.setLoggedIn})),t=J(),n=z((function(e){return e.auth.updateToken})),r=X(t),o=K.a.isString(t)||t.type!==d.Auth0?d.Azure:d.Auth0,i=U(),a=new N.CogniteClient({appId:"il-tempo-gigante"}),c=Y(K.a.isString(t)?void 0:t.clientId),s=te();return function(){var l=Object(S.a)(_.a.mark((function l(u){var d,g,h,f,b,j,v,m,O,x,y;return _.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(d=u.apiKey,g=u.tenant,h=u.token,f=u.useOIDC,i(a),b=Object(W.a)(g,r),j=b.flow,v=b.options,console.log("useOIDC: ",f),!f){l.next=21;break}if(!(j&&v&&t&&g)){l.next=20;break}return console.log("Got options: ",v),m=V({id:c,cluster:r,provider:o,configurationUrl:t.configurationUrl},v,"none"),l.next=10,a.loginWithOAuth(m);case 10:return l.next=12,a.authenticate();case 12:return l.next=14,a.setProject(g);case 14:return l.next=16,a.getCDFToken();case 16:if(!l.sent){l.next=20;break}return s(a,g),l.abrupt("return",{loggedIn:!0});case 20:return l.abrupt("return",{loggedIn:!1});case 21:if(!d){l.next=26;break}return l.next=24,ne(a,d);case 24:l.next=34;break;case 26:if(!g){l.next=34;break}if(!h){l.next=32;break}return l.next=30,oe(a,g,h,n);case 30:l.next=34;break;case 32:return l.next=34,re(a,g,n);case 34:return l.next=36,a.login.status();case 36:if(!(O=l.sent)){l.next=46;break}return x=O.user,y=O.project,p.people.set_once({$email:x,cdfTenant:y}),p.identify(x),p.register({cdfTenant:y}),h&&n(h),p.track("Logged in"),e({tenant:y,email:x,apiKey:d,loginType:d?M.apikey:M.tenant}),l.abrupt("return",{loggedIn:!0,tenant:y,user:x});case 46:return e(!1),l.abrupt("return",{loggedIn:!1});case 48:case"end":return l.stop()}}),l)})));return function(e){return l.apply(this,arguments)}}()},te=function(){var e=z((function(e){return e.auth.setLoggedIn})),t=z((function(e){return e.auth.updateToken})),n=J(),r=X(n);return function(){var n=Object(S.a)(_.a.mark((function n(o,i){var a,c,s;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=null,n.prev=1,n.next=4,o.getCDFToken();case 4:a=n.sent,n.next=9;break;case 7:n.prev=7,n.t0=n.catch(1);case 9:a&&(t(a),c=Object(R.a)(a),s=c.email||c.unique_name||c["https://twindata.io/email"],e({tenant:i,email:s,loginType:M.oauth,cluster:r||"api"}),p.people.set_once({$email:s,cdfTenant:i}),p.identify(s),p.register({cdfTenant:i}));case 10:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e,t){return n.apply(this,arguments)}}()},ne=function(){var e=Object(S.a)(_.a.mark((function e(t,n){var r,o,i,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.cognitedata.com/login/status",{headers:{"api-key":n}});case 2:return r=e.sent,e.next=5,r.json();case 5:if(o=e.sent,i=o.data,a=i.project,!0===i.loggedIn){e.next=9;break}throw new Error("Could not log in");case 9:t.loginWithApiKey({project:a,apiKey:n});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=Object(S.a)(_.a.mark((function e(t,n,r){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem($,n),e.next=3,t.loginWithOAuth({type:"CDF_OAUTH",options:{project:n,onAuthenticate:function(e){e.redirect({redirectUrl:"".concat(window.location.host,"/dshub")})},onTokens:ie(t,r)}});case 3:return e.next=5,t.authenticate();case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),oe=function(){var e=Object(S.a)(_.a.mark((function e(t,n,r,o){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem($,n),e.next=3,t.loginWithOAuth({type:"CDF_OAUTH",options:{project:n,accessToken:r,onAuthenticate:function(e){e.redirect({redirectUrl:"".concat(window.location.host,"/dshub")})},onTokens:ie(t,o)}});case 3:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),ie=function(e,t){return function(){var n=Object(S.a)(_.a.mark((function n(r){var o,i,a;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.accessToken,i=r.idToken,n.next=3,e.login.status();case 3:n.sent?(t(o),a=Object(R.a)(i),setTimeout((function(){e.authenticate()}),1e3*a.exp-(new Date).getTime())):p.track("Unable to refetch token");case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},ae=n(126),ce=function(){var e=Object(I.f)();return Object(ae.a)(Object(ae.a)({},e),{},{pushStateful:function(t){return e.push({search:e.location.search,pathname:t})},replaceStateful:function(t){return e.replace({search:e.location.search,pathname:t})}})},se=function(){var e=new URLSearchParams(Object(I.g)().search).get("method");if("apikey"===e||"tenant"===e||"oauth"===e)return e},le=n(125),ue=h.c.div.withConfig({displayName:"Collapse__TitleWrapper",componentId:"sc-16m9opz-0"})(["display:flex;align-items:center;cursor:pointer;"]),de=Object(h.c)(b.c).withConfig({displayName:"Collapse__TitleIcon",componentId:"sc-16m9opz-1"})(["transform:rotate(",");"],(function(e){return e.$visible?"90deg":"0deg"})),pe=h.c.div.withConfig({displayName:"Collapse__TitleText",componentId:"sc-16m9opz-2"})(["margin-left:10px;font-weight:bold;font-size:13px;line-height:20px;color:var(--cogs-greyscale-grey9);"]),ge=h.c.div.withConfig({displayName:"Collapse__Content",componentId:"sc-16m9opz-3"})(["margin-top:",";height:",";overflow:hidden;"],(function(e){return e.$visible?"20px":"0"}),(function(e){return e.$visible?"auto":"0"})),he=function(e){var t=e.title,n=e.children,i=e.open,a=Object(o.useState)(!1),c=Object(A.a)(a,2),s=c[0],l=c[1];return Object(o.useEffect)((function(){void 0!==i&&l(i)}),[i]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(ue,{onClick:function(){return l(!s)},children:[Object(r.jsx)(de,{$visible:s,type:"ChevronRightCompact"}),Object(r.jsx)(pe,{children:t})]}),Object(r.jsx)(ge,{$visible:s,children:n})]})},fe=h.c.div.withConfig({displayName:"LoginWithAzure__AdvancedOptionsContainer",componentId:"t0jvxy-0"})(["margin:10px 0;"]),be=function(e,t){var n=e?"Sign out":"Sign in";return t===d.Auth0?n:"".concat(n," ").concat(e?"from Microsoft":"with Microsoft")};function je(e){var t=e.isAuthenticated,n=e.isInitializing,i=e.provider,a=e.login,c=e.logout,s=Object(I.f)(),l=Object(W.a)(),u=l.flow,p=l.options,g=Object(o.useState)("AZURE_AD"===u?null===p||void 0===p?void 0:p.directory:void 0),h=Object(A.a)(g,2),f=h[0],j=h[1],v=i===d.Azure?"Azure":"";return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(b.a,{style:{height:40,width:"100%",marginTop:10},type:"secondary",onClick:function(){t?c():a(f)},children:[n?Object(r.jsx)(b.c,{type:"Loading",style:{marginRight:10,color:"var(--cogs-greyscale-grey7)"}}):null,be(t,i)]}),Object(r.jsx)(fe,{children:Object(r.jsxs)(he,{open:!!(null===p||void 0===p?void 0:p.directory),title:"Advanced ".concat(v," options"),children:[Object(r.jsx)(b.d,{title:"Override ".concat(v," tenant"),type:"text",fullWidth:!0,value:"".concat(f||""),placeholder:"contoso.onmicrosoft.com",onKeyUp:function(e){"Enter"===e.key&&(Object(W.b)("AZURE_AD",{directory:null===f||void 0===f?void 0:f.trim()}),s.go(0))},onChange:function(e){return j(e.target.value)},postfix:Object(r.jsx)(b.a,{onClick:function(){Object(W.b)("AZURE_AD",{directory:null===f||void 0===f?void 0:f.trim()}),s.go(0)},children:"Set tenant"})}),Object(r.jsx)("p",{children:"If your user is a guest user of the organization you are logging in to, specify it here."})]})})]})}var ve=n(326),me=function(e){return window.location.hostname.includes(e)},Oe=function(){return!(me("staging")||me("pr")||me("dev")||me("localhost"))},xe=function(e){return Object(R.a)(e)["https://twindata.io/tenants"]},ye=function(e){return"https://twindata.io/cdf/".concat(e)},we=function(e){var t=e&&"api"!==e?"".concat(e,"."):"";return Oe()?"https://apps-api.".concat(t,"cognite.ai"):"https://apps-api.staging.".concat(t,"cognite.ai")},ke=n.n(ve).a.create({}),Ie=function(){var e=Object(S.a)(_.a.mark((function e(t,n){var r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={params:{app:"cdf",tenant:t,redirectUrl:"".concat(window.location.origin,"/dshub")}},e.next=3,ke.get("".concat(we(n),"/tenant"),r);case 3:return o=e.sent,e.abrupt("return",o.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Ce(e){var t=e.projectMissing,n=e.invalidProject;return t?Object(r.jsx)("p",{children:"Input your project name"}):n?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("p",{children:"Check the following"}),Object(r.jsxs)("ol",{children:[Object(r.jsx)("li",{children:"Is the CDF project name spelled correctly?"}),Object(r.jsx)("li",{children:"Is there an Identity Provider set up for your CDF project?"}),Object(r.jsx)("li",{children:"Is the project using a specific CDF cluster, such as \u201cgreenfield\u201c? If so, update the cluster. You can enter the cluster name if it is not listed."}),Object(r.jsxs)("li",{children:["Is ",Object(r.jsx)("strong",{children:window.location.hostname})," in the allowed application domains list?"]})]})]}):null}var _e=h.c.div.withConfig({displayName:"LegacyLoginInput__InputHelp",componentId:"sc-1toscrm-0"})(["font-weight:500;font-size:12px;line-height:20px;color:var(--cogs-greyscale-grey7);"]),Se=h.c.div.withConfig({displayName:"LegacyLoginInput__ContinueButtonContainer",componentId:"sc-1toscrm-1"})(["margin-top:24px;padding-bottom:10px;"]);function Ae(e){var t=e.cluster,n=e.onTenantSelected,i=Object(o.useState)(""),a=Object(A.a)(i,2),c=a[0],s=a[1],l=Object(o.useState)("unknown"),u=Object(A.a)(l,2),d=u[0],p=u[1],g=Object(o.useState)(!1),h=Object(A.a)(g,2),f=h[0],j=h[1],v=function(){var e=Object(S.a)(_.a.mark((function e(r){var o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),j(!0),0!==c.length){e.next=4;break}return e.abrupt("return");case 4:return p("checking"),e.prev=5,e.next=8,Ie(c,t);case 8:o=e.sent,p(o?"valid":"invalid"),o&&n(c,t),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),p("invalid");case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(b.f,{level:"5",children:"Sign in using CDF project name"}),Object(r.jsxs)(_e,{children:["The last part of the url ",window.location.hostname,"/",Object(r.jsx)("strong",{children:"project"})]}),Object(r.jsx)(b.d,{placeholder:"Project name",fullWidth:!0,style:{marginTop:5},value:c,onChange:function(e){s(function(e){return e.toLowerCase().replace(/[^a-z0-9-]+/g,"")}(e.target.value)),j(!1)},onKeyDown:function(e){"Enter"===e.key&&v(e)},error:!f||0!==c.length&&Ie?void 0:" "}),f&&Object(r.jsx)(Ce,{projectMissing:0===c.length,invalidProject:"invalid"===d}),Object(r.jsx)(Se,{children:Object(r.jsx)(b.a,{type:"primary",onClick:v,loading:"checking"===d,children:"Continue"})})]})}var Te=n(327);function ze(e){var t=e.cluster,n=e.onClusterChange,o=e.clusters,i=o.reduce((function(e,t){return[].concat(Object(le.a)(e),Object(le.a)(t.options))}),[]).find((function(e){return e.value===t}))||{value:t,label:t};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(b.f,{level:5,style:{marginBottom:4},children:"Cluster"}),Object(r.jsx)(Te.a,{value:i,onChange:function(e){n(e)},formatCreateLabel:function(e){return"Use: ".concat(e)},options:o})]})}var Le=n(188),Ee=n(659),Fe=function(){return Object(r.jsx)(b.f,{level:5,style:{marginBottom:4,marginTop:16},children:"Project"})};function Pe(e){var t=e.sdkv3,n=e.move,i=Object(o.useState)(void 0),a=Object(A.a)(i,2),c=a[0],s=a[1],l=Object(Ee.a)([t.getBaseUrl(),"token/inspect"],Object(S.a)(_.a.mark((function e(){var n,r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/api/v1/token/inspect");case 2:return o=e.sent,e.abrupt("return",null===(n=o.data)||void 0===n||null===(r=n.projects)||void 0===r?void 0:r.map((function(e){return e.projectUrlName})));case 4:case"end":return e.stop()}}),e)})))),u=l.data,d=void 0===u?[]:u,p=l.isFetched;if(Object(o.useEffect)((function(){!c&&d.length>0&&s(d[0])}),[d,c]),p&&0===d.length)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Fe,{}),Object(r.jsxs)("p",{children:[Object(r.jsx)(b.c,{type:"ErrorStroked",style:{marginRight:10,color:"#e32351"}}),"You are successully logged in, but no projects were found. Make sure you have access to a CDF project."]})]});if(p&&d.length>0){var g=d.map((function(e){return{value:e,label:e}})),h=g.find((function(e){return e.value===c}))||{value:c,label:c};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Fe,{}),Object(r.jsx)(Le.a,{style:{margin:"20px 0"},value:h,options:g,onChange:function(e){return s(null===e||void 0===e?void 0:e.value)}}),Object(r.jsx)(b.a,{style:{marginTop:"16px"},type:"primary",disabled:!c,onClick:function(){c&&n(c)},children:"Continue"})]})}return Object(r.jsx)(r.Fragment,{})}var Ne=function(){return Object(r.jsx)(b.f,{level:5,style:{marginBottom:4,marginTop:16},children:"Tenants"})},De="selected_tenant_id";function Ue(e){var t=e.sdkv3,n=e.onTenantChanged,i=Object(o.useState)(localStorage.getItem(De)),a=Object(A.a)(i,2),c=a[0],s=a[1],l=Object(o.useState)([]),u=Object(A.a)(l,2),d=u[0],p=u[1],g=function(e){var t;s(e),t=e,localStorage.setItem(De,t),n(e)};if(Object(o.useEffect)((function(){t.getIdToken().then((function(e){if(e){var t=xe(e);p(t),!c&&(null===t||void 0===t?void 0:t.length)>0&&s(t[0].id),localStorage.removeItem(De)}}))}),[t,c]),(null===d||void 0===d?void 0:d.length)>0){var h=d.map((function(e){return{value:e.id,label:e.name}})),f=h.find((function(e){return e.value===c}))||{value:c,label:c};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ne,{}),Object(r.jsx)(Le.a,{style:{margin:"20px 0"},value:f,options:h,onChange:function(e){g((null===e||void 0===e?void 0:e.value)||"")}})]})}return Object(r.jsx)(r.Fragment,{})}var Re=function(e){var t,n,i=e.getCluster,a=e.updateCluster,c=e.clusters,s=e.move,l=L((function(e){return e.sdk.sdk})),u=U(),p=te(),g=i(),h=c.reduce((function(e,t){return[].concat(Object(le.a)(e),Object(le.a)(t.options))}),[]),f=function(e,t){return t.find((function(t){return t.value===e}))}(g,h),j=Object(o.useState)(Y(null===f||void 0===f?void 0:f.clientId)),v=Object(A.a)(j,2),m=v[0],O=v[1],x=Object(o.useState)((null===f||void 0===f?void 0:f.type)||d.Azure),y=Object(A.a)(x,2),w=y[0],k=y[1],I=a,C=Object(o.useState)(!1),T=Object(A.a)(C,2),z=T[0],E=T[1],F=Object(o.useState)(!1),P=Object(A.a)(F,2),D=P[0],R=P[1],M=Object(o.useState)(!1),H=Object(A.a)(M,2),B=H[0],q=H[1],G=h.filter((function(e){return e.legacyAuth})),J=h.filter((function(e){return!e.disableAad})),Z={id:m,provider:w,cluster:null===f||void 0===f?void 0:f.cluster,configurationUrl:null===f||void 0===f?void 0:f.configurationUrl},$=function(){var e=Object(W.a)().options,t=new N.CogniteClient({appId:"il-tempo-gigante"});u(t),t.loginWithOAuth(V(Z,e,"select_account")).then(Object(S.a)(_.a.mark((function e(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.authenticate());case 1:case"end":return e.stop()}}),e)}))))},Q=function(e){return Object(W.b)("AZURE_AD",{directory:e})},X=function(e){e&&Q(ye(xe(e)[0].id))},ee="is_two_steps_login_required";return Object(o.useEffect)((function(){var e=Object(W.a)(),t=e.flow,n=e.options,r=localStorage.getItem(ee);if("AZURE_AD"===t){R(!0);var o=new N.CogniteClient({appId:"il-tempo-gigante"});u(o),o.loginWithOAuth(V(Z,n,"none")).then(function(){var e=Object(S.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=11;break}if(localStorage.removeItem(ee),R(!0),null===n||void 0===n?void 0:n.directory){e.next=9;break}return e.t0=X,e.next=7,o.getIdToken();case 7:e.t1=e.sent,(0,e.t0)(e.t1);case 9:return e.next=11,$();case 11:E(t),q(!1),p(l);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){q(!0)})).finally((function(){r||R(!1)}))}}),[g,m]),Object(r.jsxs)(Me,{children:[Object(r.jsxs)(He,{children:[Object(r.jsx)(ze,{cluster:g,clusters:c,onClusterChange:function(e){!function(e){var t;O(Y(null===e||void 0===e?void 0:e.clientId)),k(null!==(t=null===e||void 0===e?void 0:e.type)&&void 0!==t?t:d.Azure),I(e)}(e)}}),Object(r.jsxs)(r.Fragment,{children:[z&&!!l&&Object(r.jsx)(Ue,{sdkv3:l,onTenantChanged:function(e){var t=Object(W.a)().options;(null===t||void 0===t?void 0:t.directory.includes(e))||(Q(ye(e)),$())}}),z&&!!l&&Object(r.jsx)(Pe,{sdkv3:l,move:s}),D||"true"!==(null===(t=window)||void 0===t||null===(n=t.sessionStorage)||void 0===n?void 0:n.getItem("login-clicked"))||!B&&z?null:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{style:{margin:"10px 0"},children:[Object(r.jsx)(b.c,{type:"ErrorStroked",style:{color:"var(--cogs-danger)",marginRight:10}}),"An error occurred when logging into the environment above. Make sure you are a user that belongs in an Azure tenant that has the cluster installed."]}),G.find((function(e){return e.value===g}))&&Object(r.jsxs)("div",{style:{margin:"10px 0"},children:[Object(r.jsx)("strong",{children:"It is still possible to specify the project name below."})," ","This error is not relevant for that sign in flow."]})]}),J.map((function(e){return e.value})).includes(g)&&Object(r.jsx)(je,{login:function(e){var t=Object(W.a)().options;console.log("options: ",t),R(!0),q(!1),window.localStorage.removeItem("@cognite/sdk:accountLocalId"),window.sessionStorage.setItem("login-clicked","true");var n=new N.CogniteClient({appId:"il-tempo-gigante"});u(n),n.loginWithOAuth(V(Z,t,"select_account")).then((function(){return Q(e||""),n.authenticate()})).then(function(){var e=Object(S.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t),p(l),q(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){q(!0)})).finally((function(){(null===f||void 0===f?void 0:f.type)===d.Auth0?localStorage.setItem(ee,"1"):R(!1)}))},logout:function(){window.localStorage.removeItem("@cognite/sdk:accountLocalId"),window.localStorage.removeItem("cognite__auth__v4_flow"),window.sessionStorage.removeItem("login-clicked"),K.a.forIn(window.localStorage,(function(e,t){K.a.startsWith(t,"oidc")&&window.localStorage.removeItem(t)})),E(!1)},isInitializing:D,isAuthenticated:z,provider:w})]}),G.map((function(e){return e.value})).includes(g)&&Object(r.jsx)(We,{children:Object(r.jsx)(Ae,{cluster:(null===f||void 0===f?void 0:f.cluster)||"",onTenantSelected:function(e){Object(W.c)({tenant:e,env:null===f||void 0===f?void 0:f.cluster},"COGNITE_AUTH"),s(e,"tenant")}})})]}),Object(r.jsxs)(Ke,{href:"https://docs.cognite.com/cdf/access/troubleshooting/login.html",target:"_blank",rel:"noopener noreferrer",children:["Help ",Object(r.jsx)(Be,{type:"ExternalLink"})]})]})},We=h.c.div.withConfig({displayName:"TenantSelector__LegacyContainer",componentId:"di51qd-0"})(["margin-top:30px;padding-top:30px;border-top:1px solid var(--cogs-greyscale-grey3);"]),Me=h.c.div.withConfig({displayName:"TenantSelector__Card",componentId:"di51qd-1"})(["max-width:100%;background:#fff;border-radius:4px;box-sizing:border-box;box-shadow:0px 16.8443px 50.5328px rgba(0,0,0,0.1),0px 13.4754px 20.2131px rgba(0,0,0,0.07);"]),He=h.c.div.withConfig({displayName:"TenantSelector__ContentWrapper",componentId:"di51qd-2"})(["padding:16px 32px 0;button{width:100%;height:40px;}.content{margin-top:40px;}"]),Ke=h.c.a.withConfig({displayName:"TenantSelector__HelpLink",componentId:"di51qd-3"})(["background-color:#fafafa;color:var(--cogs-text-color);padding:16px;display:flex;align-items:center;justify-content:center;border-bottom-left-radius:4px;border-bottom-right-radius:4px;"]),Be=Object(h.c)(b.c).withConfig({displayName:"TenantSelector__HelpLinkIcon",componentId:"di51qd-4"})(["margin-left:5px;"]),qe=[{label:"Multi customer environments",options:[{value:"0",cluster:"",label:"Europe 1 (Google)",legacyAuth:!0},{value:"1",cluster:"westeurope-1",label:"Europe 2 (Microsoft)"},{value:"2",cluster:"asia-northeast1-1",label:"Asia 1",legacyAuth:!0},{value:"3",cluster:"az-eastus-1",label:"US East 1"}]},{label:"Single customer environments",options:[{value:"5",cluster:"bp-northeurope",label:"BP North Europe"},{value:"6",cluster:"bp",label:"BP",legacyAuth:!0},{value:"7",cluster:"az-energinet-westeurope",label:"Energinet"},{value:"4",cluster:"westeurope-1",label:"Aize (Test)",type:d.Auth0,configurationUrl:"https://test.login.aize.io/.well-known/openid-configuration",clientId:"KthrD6rOXkrcGhsy4D1txOHzrYstaa77"},{value:"18",cluster:"westeurope-1",label:"Aize (QA)",type:d.Auth0,configurationUrl:"https://qa.login.aize.io/.well-known/openid-configuration",clientId:"Lw3aXjBwkGhYuIQuxxZrzbNt1mv1yYdO"},{value:"19",cluster:"westeurope-1",label:"Aize (Production)",type:d.Auth0,configurationUrl:"https://login.aize.io/.well-known/openid-configuration",clientId:"eHHthdNul8lJef0QqibC6xSiQ3iS7rF9"},{value:"8",cluster:"omv",label:"OMV",legacyAuth:!0},{value:"9",cluster:"pgs",label:"PGS",legacyAuth:!0},{value:"10",cluster:"power-no",label:"Power NO",legacyAuth:!0},{value:"11",cluster:"statnett",label:"Statnett",legacyAuth:!0}]},{label:"Staging environments",options:[{value:"12",cluster:"azure-dev",label:"azure-dev"},{value:"13",cluster:"bluefield",label:"bluefield"},{value:"14",cluster:"cognitedata-development",label:"cognitedata-development",legacyAuth:!0},{value:"15",cluster:"greenfield",label:"greenfield",legacyAuth:!0},{value:"16",cluster:"openfield",label:"openfield"},{value:"17",cluster:"sandfield",label:"sandfield"}]}],Ge=function(){var e=function(){var e=Object(I.f)(),t=q.a.parse(e.location.search);return function(n){n?t.env=K.a.isString(n)?n:n.value:delete t.env,n?window.localStorage.setItem(G,JSON.stringify(n)):window.localStorage.removeItem(G),e.push({search:q.a.stringify(t)})}}(),t=J(),n=K.a.isString(t)?t:t.value,o=K.a.isString(t)?t:t.cluster,i=Object(I.f)();return Object(r.jsx)(Re,{getCluster:function(){return n},clusters:qe,updateCluster:function(t){return e(t)},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"oauth";console.log("The cluster: ",o),i.push("/dshub/".concat(e,"?").concat(Object(B.stringify)(Object(ae.a)(Object(ae.a)({},o&&{cluster:o}),{},{method:t}))))}})},Je=function(){var e=L((function(e){return e.auth.apiKey})),t=L((function(e){return e.auth.tenant})),n=ee(),i=Object(o.useState)(""),a=Object(A.a)(i,2),c=a[0],s=a[1],l=Object(o.useState)(""),u=Object(A.a)(l,2),d=u[0],p=u[1],g=Object(o.useState)(!1),h=Object(A.a)(g,2),f=h[0],b=h[1],j=Object(I.g)().search,v=Object(o.useMemo)((function(){return new URLSearchParams(j)}),[j]);Object(o.useEffect)((function(){s(e||""),p(t||"")}),[e,t]),Object(o.useEffect)((function(){v.get("id_token")&&d&&(console.log("Yep: "),k())}),[v,d]);var m=ce(),O=se()||"oauth",x="apikey"===O,y="oauth"===O||"tenant"===O,w=0!==c.trim().length,k=function(){var e=Object(S.a)(_.a.mark((function e(){var t,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=3;break}return E.a.error({message:"You must provide a CDF project or a valid API key",description:"Are you sure you entered a valid api key to your tenant?"}),e.abrupt("return");case 3:return b(!0),e.prev=4,!1,t="",e.next=9,n({apiKey:c});case 9:if(r=e.sent,t=r.tenant,r.loggedIn){e.next=14;break}throw new Error("Unable to login");case 14:m.push({pathname:"/dshub/".concat(t),search:Object(B.stringify)({method:O})}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),E.a.error({message:"Could not log you in",description:"Are you sure you entered a valid api key to your tenant?"});case 20:b(!1);case 21:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{style:{overflow:"auto",scrollBehavior:"smooth"},children:Object(r.jsx)(Ye,{children:Object(r.jsx)(Ze,{children:Object(r.jsx)("div",{className:"content",children:Object(r.jsxs)($e,{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(Xe,{style:{color:"white"},children:"Welcome to DSHub lite!"}),Object(r.jsx)(Ve,{children:"DSHub lite is a Jupyter notebook run entirely in the browser. This allows you to quickly get access to data through Python notebooks, with packages like pandas, numpy and matplotlib available."})]}),Object(r.jsxs)(F.a,{style:{marginLeft:"6.625rem"},onFinish:function(){k()},children:[x&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{children:Object(r.jsx)(P.a.Password,{name:"apikey","data-id":"api-key-input",onChange:function(e){s(e.target.value)},value:c,placeholder:"Enter API key"})}),Object(r.jsx)(et,{loading:f,block:!0,htmlType:"submit",disabled:!w||f,type:"primary",children:"Access CDF EPC"})]}),y&&Object(r.jsx)(Ge,{})]})]})})})})})},Ye=h.c.div.withConfig({displayName:"LoginPage__LoginPageContainer",componentId:"sc-1chbxm6-0"})(["position:relative;display:flex;flex-direction:column;height:100vh;width:100%;background-image:url('/images/login-screen.png');background-repeat:no-repeat;background-position:center center;background-size:103% 103%;"]),Ze=h.c.div.withConfig({displayName:"LoginPage__LoginWrapper",componentId:"sc-1chbxm6-1"})(["width:100%;color:#ffffff;background:#1b21409a;margin:auto;padding:50px 120px;.content{max-width:1200px;width:100%;margin:0 auto;}"]),$e=h.c.div.withConfig({displayName:"LoginPage__LoginContent",componentId:"sc-1chbxm6-2"})(["display:grid;grid-template-columns:50% 50%;align-items:center;"]),Qe=Object(h.c)(F.a.Item).withConfig({displayName:"LoginPage__FormItem",componentId:"sc-1chbxm6-3"})(["margin-bottom:1rem;"]),Xe=h.c.h1.withConfig({displayName:"LoginPage__Title",componentId:"sc-1chbxm6-4"})(["font-weight:700;font-size:2.25rem;margin-bottom:1.25rem;"]),Ve=h.c.p.withConfig({displayName:"LoginPage__Description",componentId:"sc-1chbxm6-5"})(["font-size:1rem;line-height:1.5rem;"]),et=Object(h.c)(b.a).withConfig({displayName:"LoginPage__StyledButton",componentId:"sc-1chbxm6-6"})(["&.cogs-btn-disabled{color:#ffffff;background:var(--cogs-primary);opacity:0.7;cursor:not-allowed !important;&:hover{background:var(--cogs-primary);color:#ffffff;}}"]),tt=function(){var e=L((function(e){return e.auth.token})),t=L((function(e){return e.auth.tenant})),n=L((function(e){return e.auth.cluster}));if(e){var o=encodeURI("https://".concat(window.location.host,"/jupyter/lab/index.html?token=").concat(e,"&project=").concat(t,"&cluster=").concat(n));return Object(r.jsx)("iframe",{style:{width:"100%",height:"100%"},title:"JupyterLite",src:o})}return Object(r.jsx)(r.Fragment,{})},nt=function(){return Object(I.h)().tenantId},rt=n(658),ot=n(328),it={auth:Q,sdk:D};var at=Object(f.createStore)(it);function ct(){var e=Object(g.a)(["\n  body {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n"]);return ct=function(){return e},e}var st=Object(h.b)(ct()),lt=h.c.div.withConfig({displayName:"App__StyledPage",componentId:"sc-1kv4rmp-0"})(["display:flex;flex-flow:column;height:100%;background-color:#f5f5f5;"]),ut=h.c.div.withConfig({displayName:"App__StyledWrapper",componentId:"sc-1kv4rmp-1"})(["overflow:auto;flex:1;display:flex;flex-direction:column;position:relative;"]),dt={colors:{primary:"#6E85FC",primary_background:"#EDF0FF"}},pt=new rt.a;function gt(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(st,{}),Object(r.jsx)(h.a,{theme:dt,children:Object(r.jsx)(ot.a,{client:pt,children:Object(r.jsx)(f.StoreProvider,{store:at,children:Object(r.jsx)(k.a,{children:Object(r.jsx)(lt,{children:Object(r.jsxs)(I.c,{children:[Object(r.jsx)(I.a,{exact:!0,path:"/dshub/",children:Object(r.jsx)(Je,{})}),Object(r.jsx)(I.a,{path:"/dshub/:tenantId",children:Object(r.jsx)(ht,{children:Object(r.jsx)(ut,{children:Object(r.jsx)(I.c,{children:Object(r.jsx)(I.a,{exact:!0,path:"/dshub/:tenantId",children:Object(r.jsx)(tt,{})})})})})})]})})})})})})]})}var ht=function(e){var t=e.children,n=void 0===t?null:t,i=L((function(e){return e.auth.loggedIn})),a=L((function(e){return e.auth.tenant})),c=ee(),s=nt(),l=se(),u=new URLSearchParams(Object(I.g)().search),d=ce();return Object(o.useEffect)((function(){a!==s&&c({tenant:s,useOIDC:"oauth"===l})}),[a,s,c]),Object(o.useEffect)((function(){try{void 0===i&&("oauth"===l&&a===s?c({tenant:a,useOIDC:!0}):"tenant"===l&&a===s&&c({tenant:a,token:u.get("access_token")||void 0}))}catch(e){d.push("/dshub/")}}),[i,c,l]),l?void 0===i?Object(r.jsx)(b.e,{darkMode:!0}):Object(r.jsx)(r.Fragment,{children:n}):Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(v,{type:"Error",title:"Unable to log in",children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("p",{children:"Unable to determine your login method, please sign in again"}),Object(r.jsx)(b.a,{icon:"ArrowRight",iconPlacement:"right",type:"primary",onClick:function(){return d.push("/dshub/")},children:"Sign in again"})]})})})},ft=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,660)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(gt,{})}),document.getElementById("root")),ft((function(e){p.track(e.name,e)}))}},[[647,1,2]]]);
//# sourceMappingURL=main.96046a74.chunk.js.map